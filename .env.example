# Legal RAG Server (New)
# Supabase Configuration
SUPABASE_URL="https://your-project.supabase.co"
SUPABASE_SERVICE_ROLE_KEY="your-supabase-service-role-key-here"

# OpenAI Configuration
# Used for generating embeddings with text-embedding-3-small model
OPENAI_API_KEY="sk-your-openai-api-key-here"

# Cohere Configuration
# Used for reranking search results with rerank-v3.5 model
COHERE_API_KEY="your-cohere-api-key-here"

# Optional Configuration (uncomment to override defaults)
# LEGAL_RAG_TABLE_NAME="n8n_law_startuplaw"
# LEGAL_RAG_MATCH_FUNCTION="match_n8n_law_startuplaw"
# LEGAL_RAG_TOP_K="10"

# ============================================
# API KEY AUTHENTICATION (HTTP Mode Only)
# ============================================

# Enable API key authentication for HTTP remote access
# Set to "true" to require API keys for all HTTP endpoints (except /health and /)
# Set to "false" or omit to disable authentication (default)
# NOTE: stdio mode (local use) never requires authentication
MCP_API_AUTH_ENABLED=false

# Comma-separated list of valid API keys
# Required when MCP_API_AUTH_ENABLED=true
# Generate keys with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# Example: MCP_API_KEYS=key1,key2,key3
MCP_API_KEYS=

# Optional: Comma-separated list of key:name pairs for logging/identification
# Format: key1:ClientA,key2:ClientB,key3:Production
# Names appear in logs to identify which client made requests
# Example: MCP_API_KEY_NAMES=key1:ClaudeDesktop,key2:ProductionAPI
MCP_API_KEY_NAMES=

# ============================================
# DATABASE-BACKED AUTHENTICATION (Phase 2)
# ============================================

# Enable database-backed API key authentication (requires Supabase)
# When enabled, API keys are stored in Supabase database with:
# - Automatic rate limiting (per minute/hour/day)
# - Usage tracking and analytics
# - Key expiration and rotation support
# - Scalable to unlimited clients
# Set to "true" to use database mode (requires migration)
# Set to "false" to use environment variable mode (default)
MCP_API_AUTH_DB_ENABLED=false

# MIGRATION PATH:
# 1. Run database migration: Execute migrations/001_create_api_keys_tables.sql in Supabase SQL Editor
# 2. Create API keys: python manage_api_keys.py create --name "Client Name"
# 3. Enable database mode: Set MCP_API_AUTH_DB_ENABLED=true
# 4. Deploy and test

# API KEY MANAGEMENT:
# Create key:  python manage_api_keys.py create --name "Production Client" --expires 365
# List keys:   python manage_api_keys.py list
# Revoke key:  python manage_api_keys.py revoke <key_id_or_name>
# Rotate key:  python manage_api_keys.py rotate <key_id_or_name>
# View usage:  python manage_api_keys.py usage <key_id_or_name> --days 7
# Cleanup:     python manage_api_keys.py cleanup --days 90

# ============================================
# USAGE EXAMPLES
# ============================================

# Local development (no auth needed):
# python legal_rag_server.py

# Remote HTTP with auth enabled:
# MCP_API_AUTH_ENABLED=true
# MCP_API_KEYS=coNV6y5Ro-3f-IQoMbOuMEgJ_dqmj-touMkB6JAX6zk,Re-hWuIs7JMuVflXHG1sxXspXR9mkNd7dA5uIKBgsvo
# MCP_API_KEY_NAMES=coNV6y5Ro-3f-IQoMbOuMEgJ_dqmj-touMkB6JAX6zk:ClientA,Re-hWuIs7JMuVflXHG1sxXspXR9mkNd7dA5uIKBgsvo:ClientB
# python legal_rag_server.py --http

# Test with curl:
# curl -H "Authorization: Bearer coNV6y5Ro-3f-IQoMbOuMEgJ_dqmj-touMkB6JAX6zk" http://localhost:3000/
